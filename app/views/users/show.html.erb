<% provide(:title, @user.name) %>

<body style="background-color: #BEFF15">
  
  <% if logged_in? && current_user.admin? %>
    <div class="board-class"><h1>管理者メニュー</h1></div>
    <div> 
      <table class="table table-bordered table-condensed" id="teacher-show">
        <thead> 
          <tr> 
            <th><%= link_to "担任一覧",  teacher_index_user_path(current_user) %></th>
            <th><%= link_to "クラス一覧", schoolclasses_class_index_user_path(current_user, @schoolclass) %></th>
            <th><%= link_to "生徒一覧", student_index_3_user_path %></th>
            <th><%= link_to "担任登録", new_teacher_user_path(current_user) %></th>
            <th><%= link_to "クラス作成", new_classnumber_path(current_user) %></th>
            <th><%= link_to "管理者情報編集", edit_admin_user_path(@user) %></th>
          </tr>
        </thead>
      </table>
    </div>
  <% end %>   
          
  <% if logged_in? && current_user.teacher? %>
    <div class="board-class"><h1><%= "#{@user.class_number}：#{@user.name}" %></h1></div>
    <div> 
      <table class="table table-bordered table-condensed" id="teacher-show">
        <thead> 
          <tr>  
            <th><%= link_to "生徒一覧", student_index_user_path %></th>
            <th><%= link_to "学級だより", schoolclasses_board_create_index_user_path(current_user) %></th>
            <th><%= link_to "学校との連絡", schoolclasses_show_teacher_contact_user_path(current_user, @user) %></th>
            <th><%= link_to "担任情報編集", edit_teacher_user_path(current_user) %></th>
          </tr>
        </thead>  
      </table>
    </div>
  <% end %>
    
  <% if logged_in? %>
    <% unless current_user.admin? || current_user.teacher? %>     
      <div>

        <table class="table table-bordered table-condensed table-hover" id="table-show-guardian">
          <tr>
            <td class="guardian-3">保護者</td>
            <td class="student-name1">
              <a class="student-name3"><%= link_to "#{@user.name}", guardian_detail_user_path %></a>
              <a><%= link_to "編集", edit_guardian_user_path, class: "btn btn--green btn--student" %></a>
            </td>
            <td class="student-name1">
              <a><%= link_to "生徒登録", students_new_user_path, class: "btn btn--green btn--student" %></a>
            </td>
          </tr>
        </table>

        <table class="table table-bordered table-condensed table-hover" id="table-show-student">
          <thead>   
            <% if @students.present? %>  
            <tr>  
              <th>クラス</th>
              <th>生徒名</th>
              <th>連絡</th>
              <th>学級お知らせ</th>
            </tr>
            <% end %>
          </thead>
            <% @students.each do |student| %>
              <tr>
                <td><%= student.class_belongs %></td>
                <td class="student-name1">
                  <a class="student-name3"><%= link_to student.student_name, students_student_detail_user_path(student) %></a>
                  <a><%= link_to "編集", students_edit_student_user_path(student), class: "btn btn--green btn--student" %></a>
                </td>  
                <td><%= link_to "連絡帳", schoolclasses_index_guardian_contact_user_path(student) %>
                <td><%= link_to "学級だより", schoolclasses_guardian_board_index_user_path(student) %>
              </tr>  
            <% end %>        
        </table>
        
        <table class="table table-bordered table-condensed table-hover" id="table-show-notification">
          <thead>
            <tr>  
              <th>通知</th>
              <th>日時</th>
            </tr>
          </thead>          
              
              
              
              <% @contacts.each do |contact| %>
              <% @students.each do |student| %>
              
              <% if contact.user_id == student.id %>
                <tr>
                  <td>
                    <% if contact.guardian_post_count1 > 0 %>
                      <% if contact.title_3.present? %>
                        <%= link_to "投稿あり：#{contact.title_3}" ,schoolclasses_edit_teacherform_contact_user_path(student, date: contact.contact_date) %>
                      <% elsif contact.title_3.blank? && contact.guardian_note_1.present? %>
                        <%= link_to "投稿あり：無題", schoolclasses_edit_teacherform_contact_user_path(student, date: contact.contact_date) %>
                      <% end %>
                    <% end %>
                  </td>
                  <td>
                    <% if contact.guardian_post_count1 == 1 %>
                      <%= l(contact.updated_at, format: :short) if contact.updated_at.present? %>
                    <% elsif contact.guardian_post_count1 > contact.before_guardian_postcount1 %>
                      <%= l(contact.contact_update5, format: :short) if contact.contact_update5.present? %>
                    <% end %>
                  </td>
                </tr>
              <% end %>
              <% end %>
              <% end %>
        </table>
      
        <table class="table table-bordered table-condensed table-hover" id="table-show-notification">
          <thead>
            <tr>  
              <th>通知</th>
              <th>日時</th>
            </tr>
          </thead>          
          <% @bord_student.each do |student| %>
            <% @boards.each do |board| %> 
              <% if student.class_belongs == board.board_class %>
                <tr>
                  <td>
                    <%= link_to "#{board.board_class}学級だよりが投稿されました。", schoolclasses_show_board_user_path(student, date: board.contact_date) %>
                  </td>
                  <td>
                    <%= l(board.updated_at, format: :short) if board.updated_at.present? %>
                  </td>
                </tr>
              <% end %>
            <% end %>
          <% end %>
        </table>
      
      </div>
    <% end %> 
  <% end %>
</body>